This code sucks. I wrote it when I was a python noob. 
